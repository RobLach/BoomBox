<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Zoidcom: The Client</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
  <script language="JavaScript">
    <!--
    var Img = new Array()
    function doc_image(dateiname)
    {
      this.normal     = new Image()
      this.high       = new Image()
      this.normal.src = dateiname + ".png"
      this.high.src   = dateiname + "h.png"
      return this
    }
    function load_images(name, dateiname)
    {
      Img[name] = new doc_image(dateiname)
    }
    function show_image(name)
    {
      document[name].src = Img[name].high.src
    }
    function hide_image(name)
    {
      document[name].src = Img[name].normal.src
    }
    load_images("Intro", "intro");
    load_images("Overview", "overview");
    load_images("Manual", "manual");
    load_images("Classes", "classref");
    load_images("Headers", "headref");
   -->
   </script>
</head><body>
	      <center>
        <table width="100%" border="0" cellspacing="0" cellpadding="0" height="50">
        <tr height="50">
          <td width="42" height="50" background="headleft.png"></td>
          <td align="center" height="50" background="headback.png"><img src="headcenter.png" alt=""
              height="50" width="582"></td>
          <td width="42" height="50" background="headright.png"></td>
        </tr>
        <tr>
          <td colspan="3" align="center">
            <table width="212" border="0" cellspacing="0" cellpadding="0" align="center">
              <tr>
                <td><img src="linkleft.png" alt="" height="16" width="16" border="0"></td>
                <td><a href="index.html" onMouseOver="show_image('Intro')" onMouseOut="hide_image('Intro')"><img name="Intro" src="intro.png" alt="Introduction" height="16" width="108" border="0"></a></td>
                <td><a href="Manual.html" onMouseOver="show_image('Manual')" onMouseOut="hide_image('Manual')"><img name="Manual" src="manual.png" alt="Manual" height="16" width="108" border="0"></a></td>
                <td><a href="annotated.html" onMouseOver="show_image('Classes')"                         onMouseOut="hide_image('Classes')"><img name="Classes" src="classref.png" alt="Class Reference" height="16" width="108" border="0"></a></td>
                <td><a href="files.html" onMouseOver="show_image('Headers')"                                 onMouseOut="hide_image('Headers')"><img name="Headers" src="headref.png" alt="Header Reference" height="16" width="108" border="0"></a></td>
                <td><img src="linkright.png" alt="" height="16" width="16" border="0"></td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </center>
    
    
    
<!-- Generated by Doxygen 1.4.6-NO -->
<h1><a class="anchor" name="Client">The Client</a></h1><ul>
<li>
<a class="el" href="Client.html#cli0">Overview</a>  </li>
<li>
<a class="el" href="Client.html#cli1">Step 1: Derive from ZCom_Control</a>  </li>
<li>
<a class="el" href="Client.html#cli2">Step 2: Copy The Callback Block</a>  </li>
<li>
<a class="el" href="Client.html#cli3">Step 3: Implement The Relevant Callbacks</a> <ul>
<li>
<a class="el" href="Client.html#cli31">3.1 Getting Notified When The Connect Is Done</a>  </li>
<li>
<a class="el" href="Client.html#cli32">3.2 Handling Closing Connections</a>  </li>
</ul>
</li>
<li>
<a class="el" href="Client.html#cli4">Step 4: Instantiate The Client</a>  </li>
<li>
<a class="el" href="Client.html#cli5">Step 5: Initialize Sockets</a>  </li>
<li>
<a class="el" href="Client.html#cli6">Step 6: Initiate A Connection</a>  </li>
<li>
<a class="el" href="Client.html#cli7">Step 7: Run The Client</a>  </li>
<li>
<a class="el" href="Client.html#cli8">Done: The Client Complete</a>  </li>
</ul>
<h2><a class="anchor" name="cli0">
Overview</a></h2>
This chapter shows how to implement a client class and how to use it. It will be able to connect to a server.<p>
Server and client are both implemented by deriving from <a class="el" href="classZCom__Control.html">ZCom_Control</a>, so the client code will look very familiar. <h2><a class="anchor" name="cli1">
Step 1: Derive from ZCom_Control</a></h2>
Let's do this without further explanation:<p>
<div class="fragment"><pre class="fragment"><span class="keyword">class </span>Client : <span class="keyword">public</span> <a class="code" href="classZCom__Control.html">ZCom_Control</a> {
};
</pre></div><h2><a class="anchor" name="cli2">
Step 2: Copy The Callback Block</a></h2>
Again, the easiest way to get a compilable class is to copy the callback block from the bottom of <a class="el" href="zoidcom__control_8h.html">zoidcom_control.h</a> into the derived class:<p>
<div class="fragment"><pre class="fragment"><span class="keyword">class </span>Client : <span class="keyword">public</span> <a class="code" href="classZCom__Control.html">ZCom_Control</a> {
  <span class="keywordtype">void</span> ZCom_cbConnectResult( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#039b22bf5eba66678d30b92ed5507299">eZCom_ConnectResult</a> _result, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reply ) {}
  <span class="keywordtype">bool</span> ZCom_cbConnectionRequest( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a>  _id, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_request, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reply ){<span class="keywordflow">return</span> <span class="keyword">false</span>;}
  <span class="keywordtype">void</span> ZCom_cbConnectionSpawned( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id ) {}
  <span class="keywordtype">void</span> ZCom_cbConnectionClosed( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id,  <a class="code" href="zoidcom_8h.html#ceeefa058937820935af76cec476c6d3">eZCom_CloseReason</a> _reason, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reasondata ) {}
  <span class="keywordtype">bool</span> ZCom_cbZoidRequest( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom__prereq_8h.html#03d096b46d76272f3dad32c0ab64336b">zU8</a> _requested_level, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reason ) {<span class="keywordflow">return</span> <span class="keyword">false</span>;}
  <span class="keywordtype">void</span> ZCom_cbZoidResult( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#eddddbe24ae2655f922e0efd2bc479ec">eZCom_ZoidResult</a> _result, <a class="code" href="zoidcom__prereq_8h.html#03d096b46d76272f3dad32c0ab64336b">zU8</a> _new_level, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reason ) {}
  <span class="keywordtype">void</span> ZCom_cbNodeRequest_Dynamic( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#bad26ea4fa5a5da6a2f2ccc4c959f87e">ZCom_ClassID</a> _requested_class, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> *_announcedata,
                                   <a class="code" href="zoidcom_8h.html#e5f7ff5ea0cb32c9b0310acab3f63a64">eZCom_NodeRole</a> _role, <a class="code" href="zoidcom_8h.html#c8ad2fe4d62c7d0ba133ecd24307a655">ZCom_NodeID</a> _net_id ) {}
  <span class="keywordtype">void</span> ZCom_cbNodeRequest_Tag( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#bad26ea4fa5a5da6a2f2ccc4c959f87e">ZCom_ClassID</a> _requested_class, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> *_announcedata,
                               <a class="code" href="zoidcom_8h.html#e5f7ff5ea0cb32c9b0310acab3f63a64">eZCom_NodeRole</a> _role, <a class="code" href="zoidcom__prereq_8h.html#5469c903acc50ecf1356062dbce2edc6">zU32</a> _tag ) {}
  <span class="keywordtype">void</span> ZCom_cbDataReceived( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_data ) {}
  <span class="keywordtype">bool</span> ZCom_cbDiscoverRequest( <span class="keyword">const</span> <a class="code" href="classZCom__Address.html">ZCom_Address</a> &amp;_addr, 
                               <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_request, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reply ) {<span class="keywordflow">return</span> <span class="keyword">false</span>;}
  <span class="keywordtype">void</span> ZCom_cbDiscovered( <span class="keyword">const</span> <a class="code" href="classZCom__Address.html">ZCom_Address</a> &amp; _addr, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reply )  {}
};
</pre></div><p>
This is exactly the same as we did for the server in step 2. Now the relevant callbacks get implemented.<h2><a class="anchor" name="cli3">
Step 3: Implement The Relevant Callbacks</a></h2>
This is what the client should be able to do at the end of this chapter:<p>
<ul>
<li>
Start a connection </li>
<li>
Notice when the connection breaks down </li>
</ul>
<p>
That leaves us with this set of callbacks:<p>
<ul>
<li>
ZCom_cbConnectResult(..) for getting notified about the results of our connection attempt  </li>
<li>
ZCom_cbConnectionClosed(..) for noticing when a connection closed  </li>
</ul>
<p>
Connecting to another <a class="el" href="classZCom__Control.html">ZCom_Control</a> is asynchronous. That means, when you call ZCom_Connect() the connection process gets started but the method returns <b>before</b> the connection is established. The connection is established when ZCom_cbConnectResult() gets called with a positive result code. The net effect is that you can establish a connection to a remote host while the application can do other things in the meantime, like updating the GUI. Otherwise everything would freeze until the connection has been established.<h3><a class="anchor" name="cli31">
3.1 Getting Notified When The Connect Is Done</a></h3>
This notification is acquired through ZCom_cbConnectResult(). As soon as Zoidcom has established the connection or has given up because the remote host didn't answer, this callback gets called. We implement it here so the application can react accordingly.<p>
<div class="fragment"><pre class="fragment"><span class="keyword">class </span>Client : <span class="keyword">public</span> <a class="code" href="classZCom__Control.html">ZCom_Control</a> {
  <span class="keyword">virtual</span> <span class="keywordtype">void</span> ZCom_cbConnectResult( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#039b22bf5eba66678d30b92ed5507299">eZCom_ConnectResult</a> _result, 
                                     <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reply )
  {
    <span class="keywordflow">if</span> (_result == <a class="code" href="zoidcom_8h.html#039b22bf5eba66678d30b92ed5507299bd98b54942be80fd1ca29628751dae43">eZCom_ConnAccepted</a>)
      printf(<span class="stringliteral">"Connection established.\n"</span>);
    <span class="keywordflow">else</span>
      printf(<span class="stringliteral">"Connection failed\n"</span>);
  }

  <span class="comment">// all other callback methods omitted here</span>
};
</pre></div><p>
For a list of possible result codes see <a class="el" href="zoidcom_8h.html#039b22bf5eba66678d30b92ed5507299">eZCom_ConnectResult</a>. The _reply parameter contains anything the server has put there while executing ZCom_cbConnectionRequest().<h3><a class="anchor" name="cli32">
3.2 Handling Closing Connections</a></h3>
Exactly like the server, the client gets notified when the connection goes down through ZCom_cbConnectionClosed():<p>
<div class="fragment"><pre class="fragment"><span class="keyword">class </span>Client : <span class="keyword">public</span> <a class="code" href="classZCom__Control.html">ZCom_Control</a> {
  <span class="keyword">virtual</span> <span class="keywordtype">void</span> ZCom_cbConnectionClosed( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#ceeefa058937820935af76cec476c6d3">eZCom_CloseReason</a> _reason, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reasondata )
  {
    printf(<span class="stringliteral">"Connection to server closed"</span>);
  }
  <span class="comment">// all other callback methods omitted here</span>
};
</pre></div><h2><a class="anchor" name="cli4">
Step 4: Instantiate The Client</a></h2>
<div class="fragment"><pre class="fragment"><span class="comment">// &lt;- insert complete client class here</span>

<span class="keywordtype">int</span> main()
{
  <span class="comment">// initialize Zoidcom</span>
  <a class="code" href="classZoidCom.html">ZoidCom</a>* zcom = <span class="keyword">new</span> <a class="code" href="classZoidCom.html">ZoidCom</a>(<span class="stringliteral">"zoidcom.log"</span>);
  <span class="keywordflow">if</span> (!zcom || !zcom-&gt;<a class="code" href="classZoidCom.html#98e4a1e744c74a98a9f9247ae378ec72">Init</a>())
    exit(255);

  <span class="comment">// make instance of our Client class</span>
  Client *client = <span class="keyword">new</span> Client();

  <span class="comment">// more soon</span>
  
  <span class="keywordflow">return</span> 0;
};
</pre></div><h2><a class="anchor" name="cli5">
Step 5: Initialize Sockets</a></h2>
Unlike the server, the client doesn't need a well-known UDP port. The client is the one initiating the connection, so it is totally irrelevant which port it uses. For that reason, we leave it up to the OS to assign a free port to us.<p>
<div class="fragment"><pre class="fragment">  <span class="comment">// this creates and initializes the network sockets</span>
  <span class="comment">// true = use udp socket, 0 = let OS choose UDP port, 0 = no internal socket</span>
  <span class="keywordtype">bool</span> result = client-&gt;ZCom_initSockets(<span class="keyword">true</span>, 0, 0);
  <span class="comment">// if result is false, Zoidcom had problems while initializing</span>
  <span class="keywordflow">if</span> (!result)
    exit(255);
};
</pre></div><h2><a class="anchor" name="cli6">
Step 6: Initiate A Connection</a></h2>
One special thing the client has to do is initiating the connection to the server. This is done by calling ZCom_Connect() with the desired target address. In this example, the server is expected to run on localhost (i.e. 127.0.0.1) on port 10000.<p>
Insert this after the socket initialization code:<p>
<div class="fragment"><pre class="fragment"><a class="code" href="classZCom__Address.html">ZCom_Address</a> server_addr;
server_addr.<a class="code" href="classZCom__Address.html#896fb817a064267cb29f57335ca89e9c">setAddress</a>( <a class="code" href="zoidcom_8h.html#df333d80d26eb8251868b97511ac3776f7ee7205bd9ce7896ff2b6aa0ad97e8d">eZCom_AddressUDP</a>, 0, <span class="stringliteral">"localhost:10000"</span>);
<a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> connection_id = client-&gt;ZCom_Connect(server_addr, NULL);

<span class="comment">// unable to connect</span>
<span class="comment">// this happens if the connection process can't even be started</span>
<span class="comment">// for some reason</span>
<span class="keywordflow">if</span> (connection_id == ZCom_Invalid_ID)
  exit(255);
</pre></div><p>
I suggest you store the connection ID somewhere for later use. You need it everytime you want to send data over that connection and for other things, too.<p>
Note that it is possible to connect to as many other ZCom_Controls as you like in parallel. Each call to ZCom_Connect() returns a new connection ID, which can then be used to identify the connection in other callbacks.<p>
After ZCom_Connect() has been called, it is necessary to wait for ZCom_cbConnectResult() to get called by Zoidcom.<h2><a class="anchor" name="cli7">
Step 7: Run The Client</a></h2>
Again, just like it was done for the server:<p>
<div class="fragment"><pre class="fragment">  <span class="keywordflow">while</span> ( <span class="keyword">true</span> )
  {
    <span class="comment">// tell the client to process incoming data</span>
    client-&gt;ZCom_processInput();
    <span class="comment">// tell the client to process outgoing data</span>
    client-&gt;ZCom_processOutput();
    <span class="comment">// give up remaining cpu time</span>
    zcom-&gt;<a class="code" href="classZoidCom.html#8f45b79796d3ec0330450db21cd14bda">Sleep</a>(1);
  }
</pre></div><h2><a class="anchor" name="cli8">
Done: The Client Complete</a></h2>
This is a very simple client. It will keep running forever, unless the connection times out or the server disconnects on purpose. When the connection closes, it sets the boolean exit_now to true so that the mainloop will stop running.<p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="zoidcom_8h.html">zoidcom.h</a>&gt;</span>

<span class="keywordtype">bool</span> exit_now = <span class="keyword">false</span>;

<span class="keyword">class </span>Client : <span class="keyword">public</span> <a class="code" href="classZCom__Control.html">ZCom_Control</a> {
  <span class="keywordtype">void</span> ZCom_cbConnectResult( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#039b22bf5eba66678d30b92ed5507299">eZCom_ConnectResult</a> _result, 
                                     <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reply )  {
    <span class="keywordflow">if</span> (_result == <a class="code" href="zoidcom_8h.html#039b22bf5eba66678d30b92ed5507299bd98b54942be80fd1ca29628751dae43">eZCom_ConnAccepted</a>)
      printf(<span class="stringliteral">"Connection established. \n"</span>);
    <span class="keywordflow">else</span>
      printf(<span class="stringliteral">"Connection failed\n"</span>);
  }

  <span class="keywordtype">void</span> ZCom_cbConnectionClosed( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#ceeefa058937820935af76cec476c6d3">eZCom_CloseReason</a> _reason, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reasondata )  {
    printf(<span class="stringliteral">"Connection to server closed. Exiting...\n"</span>);
    exit_now = <span class="keyword">true</span>;
  }

  <span class="keywordtype">bool</span> ZCom_cbConnectionRequest( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a>  _id, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_request, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reply ){<span class="keywordflow">return</span> <span class="keyword">false</span>;}
  <span class="keywordtype">void</span> ZCom_cbConnectionSpawned( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id ) {}
  <span class="keywordtype">bool</span> ZCom_cbZoidRequest( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom__prereq_8h.html#03d096b46d76272f3dad32c0ab64336b">zU8</a> _requested_level, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reason ) {<span class="keywordflow">return</span> <span class="keyword">false</span>;}
  <span class="keywordtype">void</span> ZCom_cbZoidResult( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#eddddbe24ae2655f922e0efd2bc479ec">eZCom_ZoidResult</a> _result, <a class="code" href="zoidcom__prereq_8h.html#03d096b46d76272f3dad32c0ab64336b">zU8</a> _new_level, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reason ) {}
  <span class="keywordtype">void</span> ZCom_cbNodeRequest_Dynamic( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#bad26ea4fa5a5da6a2f2ccc4c959f87e">ZCom_ClassID</a> _requested_class, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> *_announcedata,
                                   <a class="code" href="zoidcom_8h.html#e5f7ff5ea0cb32c9b0310acab3f63a64">eZCom_NodeRole</a> _role, <a class="code" href="zoidcom_8h.html#c8ad2fe4d62c7d0ba133ecd24307a655">ZCom_NodeID</a> _net_id ) {}
  <span class="keywordtype">void</span> ZCom_cbDataReceived( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_data) {}
  <span class="keywordtype">void</span> ZCom_cbNodeRequest_Tag( <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> _id, <a class="code" href="zoidcom_8h.html#bad26ea4fa5a5da6a2f2ccc4c959f87e">ZCom_ClassID</a> _requested_class, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> *_announcedata,
                               <a class="code" href="zoidcom_8h.html#e5f7ff5ea0cb32c9b0310acab3f63a64">eZCom_NodeRole</a> _role, <a class="code" href="zoidcom__prereq_8h.html#5469c903acc50ecf1356062dbce2edc6">zU32</a> _tag ) {}
  <span class="keywordtype">bool</span> ZCom_cbDiscoverRequest( <span class="keyword">const</span> <a class="code" href="classZCom__Address.html">ZCom_Address</a> &amp;_addr, 
                               <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_request, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reply ) {<span class="keywordflow">return</span> <span class="keyword">false</span>;}
  <span class="keywordtype">void</span> ZCom_cbDiscovered( <span class="keyword">const</span> <a class="code" href="classZCom__Address.html">ZCom_Address</a> &amp; _addr, <a class="code" href="classZCom__BitStream.html">ZCom_BitStream</a> &amp;_reply )  {}
};

<span class="keywordtype">int</span> main()
{
  <span class="comment">// initialize Zoidcom</span>
  <a class="code" href="classZoidCom.html">ZoidCom</a>* zcom = <span class="keyword">new</span> <a class="code" href="classZoidCom.html">ZoidCom</a>(<span class="stringliteral">"zoidcom.log"</span>);
  <span class="keywordflow">if</span> (!zcom || !zcom-&gt;<a class="code" href="classZoidCom.html#98e4a1e744c74a98a9f9247ae378ec72">Init</a>())
    exit(255);

  <span class="comment">// make instance of our Client class</span>
  Client *client = <span class="keyword">new</span> Client();
  client-&gt;ZCom_setDebugName(<span class="stringliteral">"Client"</span>);

  <span class="comment">// this creates and initializes the network sockets</span>
  <span class="comment">// true = use udp socket, 0 = let OS choose UDP port, 0 = no internal socket</span>
  <span class="keywordtype">bool</span> result = client-&gt;ZCom_initSockets(<span class="keyword">true</span>, 0, 0);
  <span class="comment">// if result is false, Zoidcom had problems while initializing</span>
  <span class="keywordflow">if</span> (!result)
    exit(255);

  <span class="comment">// put this into a codeblock so that server_addr gets out of scope before </span>
  <span class="comment">// 'delete zcom;' get called (everything needs to be gone before the </span>
  <span class="comment">// ZoidCom object gets deleted)</span>
  {
    <span class="comment">// prepare the destination adress</span>
    <a class="code" href="classZCom__Address.html">ZCom_Address</a> server_addr;
    server_addr.<a class="code" href="classZCom__Address.html#896fb817a064267cb29f57335ca89e9c">setAddress</a>( <a class="code" href="zoidcom_8h.html#df333d80d26eb8251868b97511ac3776f7ee7205bd9ce7896ff2b6aa0ad97e8d">eZCom_AddressUDP</a>, 0, <span class="stringliteral">"localhost:10000"</span>);
    <span class="comment">// and connect</span>
    <a class="code" href="zoidcom_8h.html#2fbc85318e50424694925feff4cb61e3">ZCom_ConnID</a> connection_id = client-&gt;ZCom_Connect(server_addr, NULL);
  
    <span class="comment">// unable to connect</span>
    <span class="comment">// this happens if the connection process can't even be started</span>
    <span class="comment">// for some reason</span>
    <span class="keywordflow">if</span> (connection_id == ZCom_Invalid_ID)
      exit(255);
  }

  <span class="keywordflow">while</span> ( !exit_now )
  {
    <span class="comment">// tell the client to process incoming data</span>
    client-&gt;ZCom_processInput();
    <span class="comment">// tell the client to process outgoing data</span>
    client-&gt;ZCom_processOutput();
    <span class="comment">// give up remaining cpu time</span>
    zcom-&gt;<a class="code" href="classZoidCom.html#8f45b79796d3ec0330450db21cd14bda">Sleep</a>(1);
  }
  
  <span class="keyword">delete</span> client;
  <span class="keyword">delete</span> zcom;

  <span class="keywordflow">return</span> 0;
};
</pre></div> </td></tr></table>
<hr size="1"><address style="align: right;"><small>
This file is part of the documentation for Zoidcom. Documentation copyright © 2004-2008 by Jörg Rüppel. Generated on Sat Aug 16 15:26:51 2008 for Zoidcom by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.6-NO</small></address>
</body>
</html>
